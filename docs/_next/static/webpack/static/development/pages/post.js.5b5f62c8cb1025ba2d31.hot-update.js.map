{"version":3,"file":"static/webpack/static/development/pages/post.js.5b5f62c8cb1025ba2d31.hot-update.js","sources":["webpack:///./components/PostItem.js"],"sourcesContent":["import React from 'react';\nimport Router from 'next/router';\nimport Link from 'next/link';\nimport mediumZoom from 'medium-zoom';\nimport api from '../api';\nimport Title from './Title';\nimport Gitting from '../components/Gitting';\nimport PageLoad from '../components/PageLoad';\nimport Navigation from '../components/Navigation';\nimport { seo } from '../sleepy.config';\nimport { relative, format, searchParams, getNavs, t } from '../utils';\n\nexport default class extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      id: null,\n      post: {},\n      navigation: []\n    };\n    this.htmlRef = React.createRef();\n  }\n\n  componentDidMount() {\n    searchParams('id').then(id => {\n      api\n        .byId(id)\n        .then(data => {\n          this.setState(() => ({\n            id: id,\n            post: data\n          }));\n\n          this.setState(() => ({\n            navigation: getNavs(this.htmlRef.current)\n          }));\n\n          [...this.htmlRef.current.querySelectorAll('a')]\n            .filter(item => {\n              return (\n                item.children.length === 1 && item.children[0].tagName === 'IMG'\n              );\n            })\n            .map(item => {\n              item.href = 'javascript:void(0);';\n              return item.children[0];\n            })\n            .forEach(item => {\n              mediumZoom(item, {\n                background: '#BADA55',\n              });\n            });\n        })\n        .catch(() => {\n          Router.push('/error');\n        });\n    });\n  }\n\n  render() {\n    const { post, navigation } = this.state;\n    if (!post.id) {\n      return <PageLoad />;\n    }\n\n    return (\n      <div className=\"post-wrapper\">\n        <Title title={`${seo.title} | ${post.title}`} />\n        <div className=\"post-item\">\n          <div\n            className=\"content\"\n            style={{\n              padding: 0\n            }}\n          >\n            <Link href={`/post?id=${post.id}`}>\n              <a\n                className=\"title\"\n                style={{\n                  marginBottom: 10,\n                  fontSize: 18\n                }}\n              >\n                {post.title}\n              </a>\n            </Link>\n            <div\n              className=\"html markdown-body\"\n              ref={this.htmlRef}\n              dangerouslySetInnerHTML={{ __html: post.html }}\n            />\n          </div>\n          <div className=\"time\" title={format(post.created_at)}>\n            {relative(post.created_at)}\n          </div>\n          <Navigation navigation={navigation} />\n        </div>\n        {post.locked ? (\n          <div className=\"locked\">{t('commentLocked')}</div>\n        ) : (\n          <Gitting id={this.state.id} />\n        )}\n      </div>\n    );\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;AAEA;AAAA;AACA;AADA;AACA;AAAA;AACA;AACA;AACA;AACA;AAHA;AAKA;AAPA;AAQA;AACA;;;AACA;AAAA;AACA;AAAA;AACA;AAGA;AAAA;AACA;AACA;AAFA;AAAA;AACA;AAIA;AAAA;AACA;AADA;AAAA;AACA;AAGA;AAEA;AAGA;AAEA;AACA;AACA;AAEA;AACA;AADA;AAGA;AACA;AAEA;AACA;AACA;AACA;;;AAEA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AADA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AAFA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAWA;AACA;AACA;AAAA;AAAA;AAHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;;;;AA5FA;AACA;;;;;A","sourceRoot":""}